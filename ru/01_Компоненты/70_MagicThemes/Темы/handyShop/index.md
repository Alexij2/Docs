# HandyShop v1.0.0 Alpha-1 актуальный релиз.

## Введение

Тема handyShop основана на мини-движке magicThemes и позволяет создать сайт-каталог или интернет магазин на основе miniShop2 без глубокого погружения в программирование на MODX Revolution.

Тема достаточно универсальная и может подойти практически для любой области, где не нужен сложный функционал. Ознакомьтесь в разделе Возможности с перечнем допустимого.

Тема будет развиваться и совершенствоваться. Обратная связь приветствуется по любому вопросу связанного с этим пакетом.

Навыки необходимые для работы с темой не велики. Необходимо немного знать css + html + сетку bootstrap 4 (flex).
Вы как минимум должны немного знать о MODX. На данный момент рассматривается версия MODX 2.8.х. 

**Основные принципы:**
- уметь устанавливать MODX на хостинг и уметь устанавливать пакеты.
- настраивать ЧПУ и транслитерации псевдонимов. (пакет Translit)
- иметь представление о системных настройках. Уметь искать нужную настройку и изменять ее.
- уметь создавать ресурсы, шаблоны, дополнительные поля (и привязывать их к шаблонам); ресурсы привязывать к шаблонам; уметь настраивать источник файлов.

Для комфортного управления контентом в шаблоне, да и вообще на сайте желательно знать:
* Пакет Collections (для создания списков ресурсов вне дерева) + его настройка. Позволяет упростить навигацию по документам и аккуратно отображать списки ресурсов.
* Пакет translit позволяет конвертировать alias ресурса в транслит при сохранении ресурса. (работает автоматически).
* Пакет MIGX позволяет создавать простые и сложные данные в табличном виде. На его основе можно создать например, галерею фото, списки контактов, списки соц-сетей для сайта и т.п.
* Для удобного визуального редактирования контента существует пакеты (визуальные редакторы):
* TinyMCE Rich Text Editor v2.x
* или CKEditor 1.4.x
* Для редактирования кода (иногда может понадобиться) пакет ACE v1.9.x
* Для возможности вставлять фотографии, галереи в область контента есть imgsPaste (платный пакет) в данном случае он будет полезен только для раздела Новости, статьи.

Если Вам понадобиться в одностороннем порядке расширять функционал темы, то уровень требований увеличивается (php, fenom, js, css, html, мозги, magicThemes, MODX API, и пр.). 

## Установка и настройка

### Зависимости и требования
Пакеты, которые необходимо установить до того как будет производиться установка handyShop. Без них тема не продолжит установку. Эти пакеты бесплатные:
- php >= 7.2, < 8 (зависимость)
- mySql 5.7 или MariaDB. (база данных)
- MODX >= 2.8.0 <= 2.8.4 (3.х пока не поддерживается)
- pdoTols >= 2.12.10
- minishop2 >= 3.0.7
- MagicThemes >= 1.0.0
- phpThumbOn* > 1.3.3
- MIGX* >= 2.13.0
- MobileDetect* >= 2.0.2
- SuperBoxSelect >= 3.0.7
- ColorPicker >= 2.0.4
- FormIt >= 4.2.6
- AjaxForm >= 1.2.1

> Установка предполагает чистую систему, но можно устанавливать и на рабочий проект для смены темы и перехода. Но эти действия должны происходить на резервной рабочей копии проекта. Тк смена темы вероятнее всего будет не простая и не быстрая. Тут необходимы будут навыки посерьёзнее. 

### Установка пакета handyShop

####1. Устанавливаются все зависимости. 
Важно до начала установки самой темы установить <u>MagicThemes пакет</u>. Особой настройки он не требует тк устанавливает свой плагин и готов к работе.

####2. Подготовка к установке
До установки темы у вас есть ресурс главной страницы и шаблон. Чтобы не удалять шаблон настроим _сопоставление шаблона_ до установки самой темы.

   1.	Заходим в шаблон и в поле код шаблона (удаляем все что там может быть) вставляем код:    
         `{include 'file:default/corex.tpl'}`
   2. Далее заходим во вкладку ПАРАМЕТРЫ, жмем на кнопку ПАРАМЕТРЫ ПО УМОЛЧАНИЮ ЗАБЛОКИРОВАНЫ, далее жмем на кнопку СОЗДАТЬ ПАРАМЕТР.
      вписываем в поля:
      > Название: **match** <br>
   Значение: **index, main**<br>
    Жмем выполнено и сохранить. 

Теперь при установке темы этот шаблон будет для главной страницы. Кстати, переименуйте этот шаблон чтобы вы понимали что это для главной страницы.

Если вы уже успели создать шаблоны для будущего каталога, то вы можете настроить сопоставление таким же образом. В разделе описание MODX Шаблонов описаны технические детали для сопоставления.

####3. Установка темы.
   
Скачивается и устанавливается сама тема. 
Она является таким же транспортным пакетом MODX как и все остальные. При установке тема проверит есть ли все необходимые пакеты в системе, если нет, то укажет на необходимые требования в разделе Зависимостей (Dependencies).

<img src="https://file.modx.pro/files/8/c/9/8c9d1ee5a76fa0af63b7a1dca4e2d0b5.png" alt="" />

Во время установки система запишет и скопирует необходимые данные в нужные места для успешной работы. Процесс отображается в окошке консоли.

####4. Активируем тему в настройках.
   
<img src="https://file.modx.pro/files/3/9/0/390325fbc0fd424851269945d7ea1bf2.png" alt="" />   
После успешной установки необходимо зайти в настройки тем и сменить активную тему на handyShop и нажать кнопку **Применить**. Теперь тема сменилась и можно начинать создавать ресурсы для будущего каталога товаров.

На этом этапе на главной странице уже должны быть задатки областей.

### Настройка
По сути, даже с настройками по умолчанию Сайт уже может работать и остается лишь только создать ресурсы и присвоить им соответствующие шаблоны, в ТВ параметрах выставить необходимые значения, в настройках темы уточнить параметры и в штуковинах дополнительно сконфигурировать вывод данных.
Но пойдем подробнее по порядку.

####1. Настройка ресурсов.

Процес достаточно простой. Создать и назначить ресурсам свои шаблоны, которые установились с темой.
    
1. **Главная.**
   
   Зайдем в наш ресурс который был создан по умолчанию. Текст в содержимом можно сразу же удалить, чтобы не мешал.
   Далее переходим во вкладку ДОПОЛНИТЕЛЬНЫЕ ПОЛЯ. Тут уже выведены ТВ для управления поведением общих блоков для этой страницы.
   
   - Например, **Слайдер** – ваш слайдер, который будет выводиться на главной. (Естесственно, вы можете эту TV slider присвоить и другим шаблонам, тогда слайдер можно будет использовать и на других страницах со своими настройками.
   
   - **TV Выбор категорий товаров для страницы** – тут происходит выбор категорий для отображения на главной странице. Например, вам не понравиться очередность по умолчанию, то тут вы сможете настроить и очередность и необходимые категории.

   - **TV Товары для приоритетного показа** – сможете выбрать товары которые хотите отобразить в блоке товаров.
   
   - **TV Ресурсы для приоритетного показа** (Новости) – работают так же, но для раздела Новости.

2. **Каталог** 

    Создайте ресурс <strong>Каталог</strong> и присвойте ему шаблон КАТАЛОГ ГЛАВНЫЙ.
    Он настроен на простой вывод категорий каталога с под-категориями.
   
3. **Категория**
   
    Вложенная категория в Каталоге, например, с заголовком _Одежда_

    Создайте вложенный в Каталог ресурс – категорию с товарами. (не забудьте присвоить в Настройках ресурса ему тип ресурса КАТЕГОРИЯ ТОВАРОВ и назначить шаблон "<strong>Каталог. Список товаров.</strong>". Сохраните и перейдите в Дополнительные поля.

    Тут вы сможете загрузить фото для раздела, указать как обрезать фото.

    **ТВ Опции Актуальные** – тут будет выбор опций которые будут выводиться на конечной странице товара около цены списком.
    
    **ТВ Опции для выбора в корзину**. Из названия понятно, что это селекты выбора Характеристики у товара, которые обязательно нужно поместить в корзину (без смены цены) чтобы менеджер понимал, например, какой цвет выбрал человек или размер.
    
    **ТВ Опции для показа в списках товаров**. Выводятся в списках товаров для удобства поиска важных характеристик.
    
   <blockquote>Все последние 3 ТВ-настройки для категорий наследуются по иерархии от категории товара к началу дерева. Те вы сможете для каждой категории настроить свои индивидуальные параметры или группировать.</blockquote>

4. **Товары**    

   Теперь можно создать пару товаров в категориях. (шаблон подтянется автоматически, но если это не произошло проверьте настройку минишопа **ms2_template_product_default** и установите необходимый шаблон.)
   Далее. В дополнительных полях есть только тип обрезки для главного фото (иногда используется при кастомном выводе фото).

<blockquote>Характеристики и параметры заполняются только через опции:</blockquote>

   Во вкладке Свойства товара есть поле Цвета. Его настоятельно советую не использовать. Потому что это поле ограничено и на замену ему придет минишопе (в новых версиях) новый тип поля – Цвет в опциях. Где есть уже предустановленная палитра цвета и вы сможете сами сконфигурировать какие цвета вам нужны и как их назвать. Тем более что сама тема поддерживает этот новый тип поля. 
   
   Поле Размер, производитель, страна, теги – используйте если хотите в таком виде.
    
   Чек-боксы Новый, Особый(рекомендуем), Популярный(Хит) – работают в штатном режиме и эти метки выводится маленькими иконка-текстом у товара.

   Если заполнено поле СТАРАЯ ЦЕНА, то у товара появляется иконка-надпись Акция.
   
   В опциях вводятся все данные, которые предполагают фильтрацию по параметрам (в будущем).

>  **Фильтрация через ТВ параметры Штуковинами в теме не поддерживается!**

5. **Каталог с отфильтрованными товарами.**

    Далее <strong>для СЕО</strong> предусмотрен шаблон <u>Каталог. Настраиваемые списки товаров</u>.
    В нем можно выбирать опции с определенными параметрами, по которым будут отображаться товары конкретно на этой странице. Этакий мини-сео-ресурс на подобии знаменитого пакета.
   
    **ТВ опции для выбора** – просто выбираете опция-параметр. + можно комбинировать.
    Выбираете параметр с нужным(и) значением(и)) и ставим только новые (на рис.).
<img src="https://file.modx.pro/files/9/c/c/9ccbd1ccdb46a9eda58ef22e55a76972.png" alt="" />

    Так можно формировать и страницу с новинками, хитами, Советуем. И прочее на любой вкус.

    Тип документа может быть обычный ресурс. Он не привязан к категориям, я бы даже посоветовал не делать его категориями минишопа, чтобы потом не путаться.

6. **Простые страницы с текстами.**

    Для обычных текстовых страниц предусмотрен шаблон Обычная страница. Текстовая. Тут все обычно. Можно добавить галлерею, список товаров ниже или до статьи. Это делается с помощью добавления новых штуковин. _Как, описано в magicThemes._

7. **Новости или статьи.**

    Для Новостей или статей можно использовать Шаблон Новости. Список. Для Одной новости есть соответствующий Шаблон Новости. Одна новость. Для него предусмотрена галерея фотографий через MIGX и обрезка главной фотки.

8. **Контакты**

    Для страницы Контактов есть шаблон Контакты. Там выводятся штуковины отвечающие за телефоны, адрес, карту, текст, форму обратной связи.

9. **Поиск**
    
    Есть так же простой поиск на сайте. Работает через шаблон Каталог. Настраиваемые списки товаров. т.е. Создаете ресурс – Результаты поиска, присваиваете этот шаблон. Сохраняете.
    id этого ресурса вписываете в Штуковину иконки поиска. <strong>Header/panel.tpl</strong>
<img src="https://file.modx.pro/files/6/d/0/6d04528641c0e28fd086a1d1303c905e.png"  alt=""/>

    Откроется окошко:
<img src="https://file.modx.pro/files/6/b/1/6b1c3041e4737f28bd2ea522a8a2417c.png" alt="" />
    Для корзины Вы сможете id заполнить позднее, как создадите эту страницу.
    Она создается с шаблоном <strong>Корзина</strong>.
И создать страницу Спасибо за заказ. Шаблон такой же корзина.


####2. Настройка и общее понимание областей.

Коротко опишу работу движка. Есть виртуальные горизонтальные области сайта. Например можете представить что это шапка, контент и футер.
те 3 области. шапка отвечает за вывод на всем сайте шапки, футер - на всем сайте подвала, а поле контент на разных страницах _**разное**_ и в него попадают Штуковины, которые назначены в этой области и этому шаблону.

В данной теме их больше:
<img src="https://file.modx.pro/files/3/8/e/38e7444a84f679443fb7bf5462b8169f.png" alt="">

В каждой области есть разделение по количеству ячеек (позиции), нумерация от 1 до 24.
Например в шапке верхней 2, в обычной шапке header - 3. Каждая область конфигурируется в 24-х колоночной сетке и для каждого типа разрешения, поддерживаются bootstrap отступы, скрытия, сортировка. Эти классы вы можете задавать любой такой ячейке. Можно еще выбрать принадлежность к шаблонам, но это редко используется и доступна как строка для заполнения.

После изменений данных обязательно сохраняйте строку.

**header-top** – Верхняя часть шапки. Там можно располагать контактные данные, можно вывести маленькое меню, сообщение и т.п.

**header** – Основная часть шапки. Тут как правило выводится логотип, меню, иконки панели поиска , корзина, вход в личный кабинет и т.п.

**crumbs** – Для хлебных крошек. И заголовка H1.

**slider** – Слайдер. Отдельная область для слайдера.

**content_main** – одно-колоночная область для страниц, где нужна 1 колонка без оберток. Например это шаблон главаня, список статей и т.п.

**content** – одна колонка, но с обертками. Я в эту область отдал шаблонам новостей и вывел список новостей и одну новость.

**content_2row** – Две колонки. Основной вывод. Сюда попадают категории с товарами. Контакты. – все что должно иметь 2 колонки.

**footer** – Подвал сайта. Тут 4 колонки. Логотип, 2 Меню и контакты.

Можно добавлять и свои области, если они необходимы, например, создать 3х колоночный вывод для шаблона и т.п. И привязывать к ним другие Штуковины.

Для Областей можно вписывать классы, для внутренних ячеек – классы. Делить область на ячейки, на сколько это позволяет 24-х колоночная система. Ну и конфигурировать поведение ячеек для ПК, планшетов, моб устройств в зависимости от экрана.


####3. Настройка Штуковин.

Штуковины основная движущая сила. Они отображают и настраивают свою зону области ячейки. **В ячеку области можно добавить сколь угодно Штуковин.** сортировка последовательности в этом случае за полем **rank**.

Штуковин много, поэтому пока рассмотрю только несколько основных. В дальнейшем буду дополнять.

####3.1 shop/product-list-def.tpl

Например, возьмем вывод товаров на главной странице. За это у нас отвечает штука  **shop/product-list-def.tpl**, где _shop_ – папка в теме, _product-list-def.tpl_ – файловый чанк на fenom.
Нажмем на иконку – редактировать.

**Вкладка Вывод** – содержит название, привязку к позиции, тип вставки штуки, путь со значением файла.

**Вкладка Сниппет** – настройки снипета внутри чанка. Тут сугубо настройки и конфигурации для сниппета. Можно добавлять дополнительные параметры для снипета, если это необходимо.
Логика такая. У нас вывод на главной странице, значит нам не нужна пагинация, нам нужно ограничить кол-во до 4х, и выбрать из товаров только Новинки, и выбрать родителя категории, чтобы система знала id каталога.
А вот если нам нужна была бы пагинация, например на странице списков товаров в категории, то тут можно выбрать подходящий вид из 3х имеющихся вариантов – стандартная, по кнопке, скролл.

**Переходим в следующую вкладку ОБЩИЕ.** 

 _Фоновое изображение_ – список их берется из настроек темы.

 _Обернуть в контейнер_ – указывает необходимо ли оборачивать блок в связку с ограничением по ширине (width). Для ограничения используется класс container. Если выбрать НЕТ, то контент займет все пространство.

_Количество в ряду_ – выбираете кол-во товаров в 1 ряду для ПК версии. Для мобильной расчитывается автоматически и как правило это 1 шт.

_Текст заголовока у блока и Оформление заголовка_ – Если заполнен текст, то выводится заголовок этого блока с указанным оформлением.

_Изображение обрезать?_ – Указывает логику работы обрезания главного фото для всех миниатюр вывода, если это необходимо.

_В низу для ссылки id_ – id или ссылка на необходимую страницу. Ставится в ручную.

_Отображение параметров в товаре_ – Включить или выключить отображение указаных в категории товара опций для этого блока элементов.

_**Режим фотографий**_ – интересная настройка, она же есть в выводе одного товара. Определяет какую миниатюру фото брать первой. Обычно они различаются разрешениями, но есть момент.

  **A) Генерировать по факту:** Можно выбрать вариант генерации по image файлу товара, в этом случае вам не нужно конфигурировать источник файлов для minishop, а разрешение генерации вы можете выбрать сразу в параметре Размер изображения 12х23 в px.

  **Б) Сгенерированное фото ms2:** Второй вариант предполагает, что вы сконфигурировали медиаисточник для минишопа и перегенерировали превьюшки всех товаров (входит в комплект поставки темы, генерация в ручную). В этом случае вы можете вписать название миниатюры в поле и оно подхватиться в msProduct. С темой идет конфиг, в котором есть List и medium варианты генерации.

> list – Для списков товаров 200х200 <br>
medium – для страницы товара 480px.

**Вкладка СТИЛИЗАЦИЯ.**

Тут можно поиграться с оформлением элемента товара. Выравнивание блоков, заголовка, размер и цвет шрифта, цвет фона целого блока.

####3.2 shop/sort-panel-top.tpl 

Как правило хочется чтобы пользователь мог отсортировать по цене, публикации, новинкам и т.п.

Эта панелька позволяет управлять сортировкой и указанием ограничения (Limit на страницу).
На вкладке этой штуковины **«сниппет»** можно выбрать нужные поля сортировки и включить лимиты для страницы, причем какие это лимиты вы можете задать сами в ручную введя значения.
Думаю, тут остальное интуитивно понятно.

####3.2 feature/migx-block-list.tpl

Это блок преимуществ на migx. Но не только приемуществ, но и всего того что попадает под параметры этой Штуковины.

**Вкладка Сниппета.**

Тут 2 поля одно для вставки имени конфига из системной настройки и имя TV поля для ресурса (если данные вы хотите брать из ресурса). Т.е. вы можете где угодно добавлять данные и выводить их через нужные переменные. (лучше, конечно, в конфиге тк он не привязан к ресурсу).

**Вкладка ОБЩИЕ.**

Тут уже есть знакомые настройки фон, обертка, кол-во, текст и оформление заголовка. Остановлюсь на не известных.

 _Вид кнопки_ – для кнопки у блока можно подобрать необходимый размер а параметром Текст на кнопке – вы пишите текст который будет отображаться, причем, если тут пусто, то кнопка не выводится.

 _Ограничение знаков_ – для поля описание, если необходимо.

 _Перекрасить PNG иконку_ – интересная фишка. Если вы вставляете одноцветные иконки на прозрачном фоне, то вы можете попробовать перекрасить их прямо тут под цвет сайта, Если же перекрашивание не нужно, то просто оставьте поле пустым.

**Вкладка СТИЛИЗАЦИЯ**

Подписи к параметрам достаточно говорящие, единственно в конце Разделяющие линии. Полезная штука, если нужно убрать/добавить изюминку к оформлению. Линия визуально разделяет блоки. В демо может выглядеть так:

<img src="https://file.modx.pro/files/8/7/5/8759d38dabc222ca0bdca1910eba7fb8.png" alt="">

> Каждая штуковина имеет свои такие мелкие настройки. В большинстве случаем названия интуитивно понятны.

В общей таблице штуковин. Так же вы всегда можете отключить принадлежность в шаблону. **Поле вложенность – уже устарело, как это не странно.**

**3.3. Дополнительные особенности для Штуковин:**

####3.3.1 header/logo.tpl
Штуковина берет настройки системные из настройки системы, вкладка Логотип.

####3.3.2. header/contacts.tpl
Так же берет настройки из настроек, но только одной handyshop_contakts, во вкладке Общие вы можете выбрать какие поля (адрес, телефон, время работы, email) показать, для мобильной версии для шапки предусмотрено включение режима спойлер (прячется текст, отображается иконка) и по клику на иконку открывается текст (режим работы, телефоны и тп). Показать иконки – покажет или скроет иконки при выводе.

####3.3.3. cart/order-form.tpl
Тут в настройке для снипета не забудьте указать id страницы Спасибо за заказ. В общих можно выбрать отображение полей адреса заказа – одним полем или набором полей.

####3.3.4. header/menu-top.tpl
Представляет собой главное меню. Для моб. Устройств переключается в бургер и работает выдвигающимся меню.

>**Постепенно функции будут расширятся, при вашем содействии. Поэтому не стесняйтесь в советах по функционалу.**

